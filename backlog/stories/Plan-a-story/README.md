## #DOING Plan a story
As a developer I would like to plan a story and make it visible by adding tasks to a story markdown in my repo
- [x] Set default branch (Ask on init)
- [x] Set working remote (Ask on init)
- [x] Rename `import` to `plan`
- [ ] Implement git automation
  1.  Fetch from working remote
  2.  Checkout default branch
  3.  Checkout or create story branch
  4.  If it's not a git repo ask to init
- [ ] Add the story project
- [ ] Move the story task to DOING
- [ ] When we ask for tasks automatically add the DoD, so the user can delete ones that aren't relevant
  - [ ] Ask for story id
  - [ ] Ask for story description
  - [ ] Ask for tasks with inquirer 
- [ ] Generate task list in a tasks README: `backlog/stories/<story-id>/tasks/README.md`
  - Put a comment at the top of the file that say's it's autogenerated
  - Each task should have a relative path link back to task file it came from
- [ ] Commit and push the story branch with force
**{{line}}**
<!--
#story
created:2023-10-08T15:06:13.331Z
task-id:BSgB3
story-id:Plan-a-story order:0
-->

## Plan a story
```mermaid
gitGraph
    commit
    commit
    branch story/123
    checkout story/123
    commit id: "add story project `backlog/stories/123`"
    commit id: "Move story to DOING"
    commit id: "Plan story with tasks `backlog/stories/123/tasks`"
    commit id: "Add diagram for story"
    commit id: "Add task list and DoD to `backlog/stories/123/tasks/README.md`"
    checkout main
    commit
    commit
    commit
    checkout story/123
    merge main
    branch story/123/tasks/a-task-on-story123
    checkout story/123/tasks/a-task-on-story123
    commit id: "start `backlog/stories/123/tasks/a-task-on-story123.md`"
    commit id: "Add digram for task"
    commit
    commit id: "complete `backlog/stories/123/tasks/a-task-on-story123.md`"
    checkout main
    merge story/123/tasks/a-task-on-story123
```

## Plan a story flow
```mermaid
flowchart
  start((Plan a story))
    --> askForStoryId(Prompt for storyId)
    --> changesExist{Are there local changes?}
  
  checkoutDefaultBranch(Checkout default branch)
    --> fetch(Fetch --all)
    --> pullDefaultBranch(Pull default branch with force)
    --> storyBranchExists{Does story branch exist?}

  mergeDefaultBranch(Merge default branch)
    --> createStoryProject(Create story project)
    --> moveStoryToDOING(Move story to DOING)
    --> promptForStoryTasks(Prompt for story tasks)
    --> addTaskFilesToStory(Add task and DoD files to story)
    --> addTasksAndDoDToReadme(Add imdone tasks and DoD in story project \n to `tasks/README.md` reporting file)
    --> commitAndPushStoryBranch(Commit and push story branch with force)

  changesExist
    -- yes --> 
      gitStash(Git stash)
      --> checkoutDefaultBranch
  changesExist
    -- no -->
      checkoutDefaultBranch

  storyBranchExists 
    -- yes -->
      checkoutStoryBranch(Checkout story branch)
      --> pullStoryBranch(Pull story branch with force)
      --> mergeDefaultBranch
  storyBranchExists 
    -- no -->
      createAndCheckoutStoryBranch(Create and checkout story branch)
      --> mergeDefaultBranch
```